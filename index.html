<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>sommelier simulator</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <link rel="stylesheet" href="css/style.css">

    <script src="https://code.jquery.com/jquery-3.1.0.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <script src="http://ajax.aspnetcdn.com/ajax/knockout/knockout-3.3.0.js"> </script>
    <script defer src="js/wineBase.js"></script>
    <script defer src="js/viewmodel.js"></script>
  </head>
  <body>
    <div class="flex-wrapper">
      <div class="main-wrapper">

<!--******************* Главное окно: добавление сомелье ************************************ -->
        <div class="sommelier-screen" data-bind="visible: sommeliersVisible">
          <div class="create-sommelier">
            <input type="text" name="name" value="" data-bind="value: newSommelierName">
            <button type="button" name="button" class="btn btn-primary" data-bind="click: addSommelier, css: {disabled: !newSommelierName()}">Add Sommelier</button>
          </div>

          <table data-bind="foreach: sommeliers">
            <tr>
              <td data-bind="text: name"></td>
              <td><button type="button" name="button" class="btn" data-bind="enable: canTest, click: $root.getWines, text: drinkStatusText, css: {disabled: !canTest(), 'btn-success': !canTest()}">Drink some wine</button></td>
            </tr>
          </table>

          <button type="button" name="button" data-bind="click: showResults">See results</button>
        </div>

<!--******************* Окно дегустирования ************************************ -->
        <div class="sommelier-screen" data-bind="with: wineList, visible: wineTestVisible">
          <table>
            <thead><tr>
              <th>Test wine</th><th>Rating</th>
            </tr></thead>
            <tbody data-bind="foreach: wines">
              <tr>
                <td data-bind="text: hideName()"></td>
                <td><select data-bind="options: [1, 2, 3, 4, 5], value: sommelierRating, click: insertSommelierRating($parent.sommelierName)"></select></td>
                <!-- тут у меня возникили проблемы при добавлении в ассоциативный массив рейтинга ключа с именем сомелье (value: rating[$parent.sommelierName])-->
                <!-- при загрузке страницы, т.к. сомелье еще не создан, в массиве создается ключ undefined со значением 1-->
                <!-- исправлять я это не стал, а просто учел этот факт при рассчете среднего значения рейтинга-->
              </tr>
            </tbody>
          </table>
          <button type="button" name="button" data-bind="click: $root.saveTable">Save</button>
        </div>

<!--******************* Окно результатов дегустирования ************************************ -->
        <div class="sommelier-screen" data-bind="with: wineList, visible: resultsVisible">
          <table>
            <th>Test wine</th><th>Age</th><th>Average</th>
            <tbody data-bind="foreach: wines">
              <tr>
                <td data-bind="text: name"></td>
                <td data-bind="text: age"></td>
                <td data-bind="text: getAverageScore()"></td>
              </tr>
            </tbody>
          </table>
          <button type="button" name="button" data-bind="click: $root.hideResults">OK</button>
        </div>
      </div>
    </div>


  </body>
</html>
